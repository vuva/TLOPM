[DEFAULT]

user: vuva


sender = pc21.filab.uni-hannover.de
router = pc38.filab.uni-hannover.de
receiver = pc48.filab.uni-hannover.de

[clocksync]
host:%(sender)s
command: echo "clocks synced"; 

[start]
host:%(sender)s
command:killall -INT python3; python3 -m http.server;
after: {'clocksync':'clocks synced'}

[receiver]
host:%(receiver)s
command:sudo killall -INT tcpdump; sudo tcpdump tcp and net 10.1.1.0/24 or 10.1.2.0/24 or 10.1.3.0/24 -i eth5 -w ~/logs/outage/dump-receiver.pcapng -j adapter;
after: {'start':'Serving HTTP'}

[receiver-request]
host:%(receiver)s
command: sleep 10; wget 10.1.2.2:8000/%(SL_FILE)s
after: {'start':'Serving HTTP'}

[sender-tshark]
host:%(sender)s
command:sudo killall -INT tcpdump; sudo tcpdump tcp and net 10.1.1.0/24 or 10.1.2.0/24 or 10.1.3.0/24 -i any -w ~/logs/outage/dump-sender.pcapng -j adapter;
after: {'start':'Serving HTTP'}

[router]
host:%(router)s
command:killall -INT python3; python3 ~/Working/TLOPM/mod-connection.py -i lanm1 -d exp -dp 10 -l exp 30 & python3 ~/Working/TLOPM/mod-connection.py -i lanm2 -d exp -dp 10 -l exp 30;
after: {'start':'Serving HTTP'}

[cleanupRecv]
host: %(receiver)s
command:sudo killall -INT tcpdump; sudo killall -INT tshark; sudo tshark -r ~/logs/outage/dump-receiver.pcapng -l -i eth5 -T fields -e frame.number -e frame.time_epoch -e ip.src -e tcp.srcport -e ip.dst -e tcp.dstport -e ip.proto -e frame.len -e tcp.seq -e tcp.ack -e tcp.options.mptcp.rawdataseqno -e tcp.options.mptcp.rawdataack > ~/logs/outage/%(SL_EX)s-receiver-%(SL_I)s.csv ;
after: {'receiver-request':'saved'}

[cleanupRouter]
host: %(router)s
command: sleep 10; killall -INT python3; tevc -e spork-join/VPlayGround now lanm1 modify delay=30ms;tevc -e spork-join/VPlayGround now lanm2 modify delay=30ms;
after: {'receiver-request':'saved'}

[cleanupSender]
host: %(sender)s
command: sudo killall -INT tcpdump;sudo killall -INT tshark; killall -INT python3; sudo tshark -r ~/logs/outage/dump-sender.pcapng -l -i eth2 -i eth4 -T fields -e frame.number -e frame.time_epoch -e ip.src -e tcp.srcport -e ip.dst -e tcp.dstport -e ip.proto -e frame.len -e tcp.seq -e tcp.ack -e tcp.options.mptcp.rawdataseqno -e tcp.options.mptcp.rawdataack > ~/logs/outage/%(SL_EX)s-sender-%(SL_I)s.csv; echo "HTTP server down."
after: {'receiver-request':'saved'}
