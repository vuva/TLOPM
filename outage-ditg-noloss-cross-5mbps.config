[DEFAULT]

user: vuva
password: vuva@dac

sender = pc22.filab.uni-hannover.de
router = pc27.filab.uni-hannover.de
receiver = pc21.filab.uni-hannover.de
DAG= 172.23.90.219
sendermac1 = 00:1b:21:6b:cc:30
sendermac2 = 00:1b:21:6b:cc:32
receivermac = 00:1b:21:6c:50:8a

[start]
host:%(receiver)s
command:killall -INT ITGRecv; ~/D-ITG-2.8.1-r1023/bin/ITGRecv;

[sender]
host:%(sender)s
command: sleep 10; ~/D-ITG-2.8.1-r1023/bin/ITGSend -T TCP -a 10.1.1.2 -t %(SL_EXPTIME)s000 -c 1000 -O 863 & ~/D-ITG-2.8.1-r1023/bin/ITGSend -a 10.1.3.3 -t %(SL_EXPTIME)s000 -c 1000 -0 1 1200;
after: {'start':'ITGRecv version'}

[sender-cross]
host:%(sender)s
command:sleep 10;~/D-ITG-2.8.1-r1023/bin/ITGSend -a 10.1.2.3 -t %(SL_EXPTIME)s000 -c 1000 -O 863 & ~/D-ITG-2.8.1-r1023/bin/ITGSend -a 10.1.3.3 -t %(SL_EXPTIME)s000 -c 1000 -W 1 600;
after: {'start':'ITGRecv version'}


[dag-capture]
host:%(DAG)s
command:sudo killall -INT dagsnap; sudo dagsnap -d0 -v -o %(SL_EX)s-%(SL_I)s.erf &
after: {'start':'ITGRecv version'}

[router]
host:%(router)s
command:killall -INT python3; killall -INT ITGRecv; ~/D-ITG-2.8.1-r1023/bin/ITGRecv;
after: {'start':'ITGRecv version'}

[cleanupRecv]
host: %(receiver)s
command: killall -INT iperf3; echo "Iperf server down."
after: {'sender':'Finished'}

[cleanupRouter]
host: %(router)s
command: sudo killall -INT ITGRecv;
after: {'sender':'Finished'}

[cleanupSend]
host: %(receiver)s
command: killall -INT iperf3; sudo killall -INT ITGSend;
after: {'sender':'Finished'}


[cleanupDAG]
host: %(DAG)s
command: sudo killall -INT dagsnap; /home/brenton/wireshark-2.4.2/tshark -r %(SL_EX)s-%(SL_I)s.erf -l -Y "eth.dst ==%(receivermac)s" -i any -T fields -e frame.number -e frame.time_epoch -e ip.src -e tcp.srcport -e ip.dst -e tcp.dstport -e ip.proto -e frame.len -e tcp.seq -e tcp.ack -e tcp.options.mptcp.rawdataseqno -e tcp.options.mptcp.rawdataack > dag-%(SL_EX)s-receiver-%(SL_I)s.csv; /home/brenton/wireshark-2.4.2/tshark -r %(SL_EX)s-%(SL_I)s.erf -l -Y "eth.src ==%(sendermac1)s || eth.src ==%(sendermac2)s" -i any -T fields -e frame.number -e frame.time_epoch -e ip.src -e tcp.srcport -e ip.dst -e tcp.dstport -e ip.proto -e frame.len -e tcp.seq -e tcp.ack -e tcp.options.mptcp.rawdataseqno -e tcp.options.mptcp.rawdataack > dag-%(SL_EX)s-sender-%(SL_I)s.csv; rm %(SL_EX)s-%(SL_I)s.erf;
after: {'sender':'Finished'}
