[DEFAULT]

user: vuva
password: vuva@dac

sender = pc75.filab.uni-hannover.de
receiver = pc77.filab.uni-hannover.de
DAG= 172.23.90.219

[clocksync]
host:%(sender)s
command: echo "clocks synced";

[start]
host:%(receiver)s
command:killall -INT iperf3; iperf3 -s;
after: {'clocksync':'clocks synced'}

[receiver]
host:%(receiver)s
command:sudo killall -INT tcpdump; sudo tcpdump tcp and dst 10.1.1.2 and src 10.1.1.3 -i any -w ~/logs/outage/dump-receiver.pcapng -j adapter --time-stamp-precision=nano;
after: {'start':'Server listening'}

[sender]
host:%(sender)s
command: sleep 10; iperf3 -c 10.1.1.2 -t %(SL_EXPTIME)s
after: {'start':'Server listening'}

[sender-tshark]
host:%(sender)s
command:sudo killall -INT tcpdump; sudo tcpdump tcp and dst 10.1.1.2 and src 10.1.1.3 -i any -w ~/logs/outage/dump-sender.pcapng -j adapter --time-stamp-precision=nano;
after: {'start':'Server listening'}

[dag-capture]
host:%(DAG)s
command:sudo killall -INT dagsnap; sudo dagsnap -d0 -v -o %(SL_EX)s-%(SL_I)s.erf &
after: {'start':'Server listening'}




[cleanupRecv]
host: %(receiver)s
command: killall -INT iperf3; sudo killall -INT tcpdump; sudo killall -INT tshark; sudo tshark -r ~/logs/outage/dump-receiver.pcapng -l -i any -T fields -e frame.number -e frame.time_epoch -e ip.src -e tcp.srcport -e ip.dst -e tcp.dstport -e ip.proto -e frame.len -e tcp.seq -e tcp.ack -e tcp.options.mptcp.rawdataseqno -e tcp.options.mptcp.rawdataack > ~/logs/outage/%(SL_EX)s-receiver-%(SL_I)s.csv ; rm ~/logs/outage/dump-receiver.pcapng; echo "Iperf server down."
after: {'sender':'iperf Done.'}



[cleanupSender]
host: %(sender)s
command: sudo killall -INT tcpdump; sudo killall -INT tshark; sudo tshark -r ~/logs/outage/dump-sender.pcapng -l -i any -T fields -e frame.number -e frame.time_epoch -e ip.src -e tcp.srcport -e ip.dst -e tcp.dstport -e ip.proto -e frame.len -e tcp.seq -e tcp.ack > ~/logs/outage/%(SL_EX)s-sender-%(SL_I)s.csv; rm ~/logs/outage/dump-sender.pcapng;
after: {'sender':'iperf Done.'}

[cleanupDAG]
host: %(DAG)s
command: sudo killall -INT dagsnap; /home/brenton/wireshark-2.4.2/tshark -r %(SL_EX)s-%(SL_I)s.erf -l -Y "eth.dst ==a0:36:9f:15:bc:48" -i any -T fields -e frame.number -e frame.time_epoch -e ip.src -e tcp.srcport -e ip.dst -e tcp.dstport -e ip.proto -e frame.len -e tcp.seq  > dag-%(SL_EX)s-receiver-%(SL_I)s.csv; /home/brenton/wireshark-2.4.2/tshark -r %(SL_EX)s-%(SL_I)s.erf -l -Y "eth.src ==a0:36:9f:0c:b8:3f" -i any -T fields -e frame.number -e frame.time_epoch -e ip.src -e tcp.srcport -e ip.dst -e tcp.dstport -e ip.proto -e frame.len -e tcp.seq -e tcp.ack -e tcp.options.mptcp.rawdataseqno -e tcp.options.mptcp.rawdataack > dag-%(SL_EX)s-sender-%(SL_I)s.csv;rm %(SL_EX)s-%(SL_I)s.erf;
after: {'sender':'iperf Done.'}
